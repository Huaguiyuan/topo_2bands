%% Band: Calculate the BAND STRUCTURE
function [E1,E2,k_label,title_name] = Band(K_path,nk)
%% ======================================
L1=1;L2=0.5;L3=L1;LAB=L3;                    %%          
LAA=2;LBB=10;                                %%	
mu=0;
%--------------------------------------------
%% ======================================
%--------------------------------------------
%the path in BZ
tic
%----------------11111111111111-------------------------
[K,k_label]=GeneKPoint(K_path);
%-------------------------------------------------------
%========================================================
%% =================================================
%   figure
%   scatter3(K(:,1),K(:,2),K(:,3),'.');
%   xlim([-2*pi 2*pi]);ylim([-2*pi 2*pi]);zlim([-2*pi 2*pi]);
%   xlabel('k_x');ylabel('k_y');zlabel('k_z');
% %======================================================
%% =================================================
dx=-(1/L1+1/L2*cos(K(:,2)-K(:,1))+1/L3*cos(K(:,1))+1/LAB*cos(K(:,1)-K(:,3)));
dy=-(1/L2*sin(-K(:,2)+K(:,1))+1/L3*sin(K(:,1))+1/LAB*sin(K(:,1)-K(:,3)));
dz=(1/LAA-1/LBB)*(1+mu-cos(K(:,3)));
d0=(1/L1+1/L2+1/L3+1/LAB)+(1/LAA+1/LBB)*(1-cos(K(:,3)));
E1=(d0+(dx.^2+dy.^2+dz.^2).^(1/2)).^(1/2);
E2=(d0-(dx.^2+dy.^2+dz.^2).^(1/2)).^(1/2);
%%==========================================================
%% ===========================================================

%title_name=[];
if LAA==LBB
    title_name=['ABC-stacked Circuit, L_1=' num2str(L1) ',L_2=' num2str(L2) ',L_3=' num2str(L3) ...
        ';L_{AB}=' num2str(LAB) ',L_{AA}= L_{BB}=' num2str(LAA)];
else
    title_name=['ABC-stacked Circuit, L_1=' num2str(L1) ',L_2=' num2str(L2) ',L_3=' num2str(L3) ...
        ';L_{AB}=' num2str(LAB) ',L_{AA}\neq L_{BB}'];
end

toc