function [D,Velocity_a,Velocity_b]=EigHamil(func,a,b,K_3D)
%% ====================================================
global L1 L2 L3 LAB LAA LBB mu;

% a1=[1 0 0]';
% a2=[0 1 0]';
% a3=[0 0 1]';

a1=[sqrt(3)/2 -1/2 0]';
a2=[sqrt(3)/2 1/2 0]';
a3=[0 0 1]';

%% ================================================================
	d0 = 0;
	d0_1 = 0;
	d0_2 = 0;
	d0_3 = 0;

	d1 = -(1/L1+1/L2*cos(K_3D*(a1-a2))+1/L3*cos(K_3D*a1)+1/LAB*cos(K_3D*(a1-a3)));
	d1_1 = -(1/L2*sin(K_3D*(a2-a1))-1/L3*sin(K_3D*a1)-1/LAB*sin(K_3D*(a1-a3)));
	d1_2 = -(-1/L2*sin(K_3D*(a2-a1)));
	d1_3 = -(1/LAB*sin(K_3D*(a1-a3)));

	d2 = -(1/L2*sin(K_3D*(a1-a2))+1/L3*sin(K_3D*a1)+1/LAB*sin(K_3D*(a1-a3)));
	d2_1 = -(1/L2*cos(K_3D*(a1-a2))+1/L3*cos(K_3D*a1)+1/LAB*cos(K_3D*(a1-a3)));
	d2_2 = -(-1/L2*cos(K_3D*(a1-a2)));
	d2_3 = -(-1/LAB*cos(K_3D*(a1-a3)));

	d3 = (1/LAA-1/LBB)*(1+mu-cos(K_3D*(a3)));
	d3_1 = 0;
	d3_2 = 0;
	d3_3 = (1/LAA-1/LBB)*(sin(K_3D*(a3)));
%% =======================================================
	Hamiltonian = [d0+d3,d1-1j*d2;
				   d1+1j*d2,d0-d3];
	[v,D] = func(Hamiltonian);
%% ====================================================
	if (a==1 && b==2) || (a==2 && b==1);
		H_1 = [d0_1+d3_1,d1_1-1j*d2_1;
			   d1_1+1j*d2_1,d0_1-d3_1];
		H_2 = [d0_2+d3_2,d1_2-1j*d2_2;
			   d1_2+1j*d2_2,d0_2-d3_2];
		Velocity_a = v(:,1)'*H_1*v(:,2);
		Velocity_b = v(:,2)'*H_2*v(:,1);
	elseif (a==1 && b==3) || (a==3 && b==1);
		H_1 = [d0_1+d3_1,d1_1-1j*d2_1;
			   d1_1+1j*d2_1,d0_1-d3_1];
		H_3 = [d0_3+d3_3,d1_3-1j*d2_3;
			   d1_3+1j*d2_3,d0_3-d3_3];
		Velocity_a = v(:,1)'*H_1*v(:,2);
		Velocity_b = v(:,2)'*H_3*v(:,1);
	else (a==2 && b==3) || (a==3 && b==2);
		H_2 = [d0_2+d3_2,d1_2-1j*d2_2;
			   d1_2+1j*d2_2,d0_2-d3_2];
		H_3 = [d0_3+d3_3,d1_3-1j*d2_3;
			   d1_3+1j*d2_3,d0_3-d3_3];
		Velocity_a = v(:,1)'*H_2*v(:,2);
		Velocity_b = v(:,2)'*H_3*v(:,1);		
	end

end